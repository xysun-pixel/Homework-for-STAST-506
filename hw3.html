<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>hw3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw3_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw3_files/libs/quarto-html/quarto.js"></script>
<script src="hw3_files/libs/quarto-html/popper.min.js"></script>
<script src="hw3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw3_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">hw3</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="problem-1" class="level2">
<h2 class="anchored" data-anchor-id="problem-1">Problem 1</h2>
</section>
<section id="a" class="level2">
<h2 class="anchored" data-anchor-id="a">a</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org/"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"haven"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'haven' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vix_d <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"VIX_D.xpt"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vix_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 57
   SEQN VIQ110 VIQ121 VIQ130 VIQ141 VIQ150 VIQ160 VIQ170 VIXNC1 VIXNC2 VIQ180
  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 31129      2     NA      2     NA     NA     NA     NA     NA     NA      2
2 31130     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 31131      2     NA      2     NA     NA     NA     NA     NA     NA      2
4 31132      2     NA      2     NA      1      1      1      5     14      2
5 31133      2     NA      2     NA     NA     NA     NA     NA     NA      2
6 31134      2     NA      2     NA      1      1      1      5     15      2
# ℹ 46 more variables: VIQ191 &lt;dbl&gt;, VIQ200 &lt;dbl&gt;, VIQ211 &lt;dbl&gt;, VIQ220 &lt;dbl&gt;,
#   VIQ230 &lt;dbl&gt;, VIQ240 &lt;dbl&gt;, VIQ250 &lt;dbl&gt;, VIXPRS &lt;dbl&gt;, VIXPRC &lt;dbl&gt;,
#   VIXPRA &lt;dbl&gt;, VIXPLS &lt;dbl&gt;, VIXPLC &lt;dbl&gt;, VIXPLA &lt;dbl&gt;, VIXOCMT &lt;dbl&gt;,
#   VIXORSM &lt;dbl&gt;, VIXORCM &lt;dbl&gt;, VIXORAM &lt;dbl&gt;, VIDORFM &lt;dbl&gt;, VIXOLSM &lt;dbl&gt;,
#   VIXOLCM &lt;dbl&gt;, VIXOLAM &lt;dbl&gt;, VIDOLFM &lt;dbl&gt;, VIXKRM1 &lt;dbl&gt;, VIXKRD1 &lt;dbl&gt;,
#   VIXKRG1 &lt;dbl&gt;, VIXKRM2 &lt;dbl&gt;, VIXKRD2 &lt;dbl&gt;, VIXKRG2 &lt;dbl&gt;, VIXKRMM &lt;dbl&gt;,
#   VIXKRDM &lt;dbl&gt;, VIXKRCD &lt;dbl&gt;, VIXKRCG &lt;dbl&gt;, VIXKLM1 &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>demo_d <span class="ot">&lt;-</span> <span class="fu">read_xpt</span>(<span class="st">"demo_D.xpt"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demo_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 43
   SEQN SDDSRVYR RIDSTATR RIDEXMON RIAGENDR RIDAGEYR RIDAGEMN RIDAGEEX RIDRETH1
  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 31127        4        2        2        1        0       11       12        3
2 31128        4        2        1        2       11      132      132        4
3 31129        4        2        2        1       15      189      190        4
4 31130        4        2        2        2       85       NA       NA        3
5 31131        4        2        2        2       44      535      536        4
6 31132        4        2        2        1       70      842      843        3
# ℹ 34 more variables: DMQMILIT &lt;dbl&gt;, DMDBORN &lt;dbl&gt;, DMDCITZN &lt;dbl&gt;,
#   DMDYRSUS &lt;dbl&gt;, DMDEDUC3 &lt;dbl&gt;, DMDEDUC2 &lt;dbl&gt;, DMDSCHOL &lt;dbl&gt;,
#   DMDMARTL &lt;dbl&gt;, DMDHHSIZ &lt;dbl&gt;, DMDFMSIZ &lt;dbl&gt;, INDHHINC &lt;dbl&gt;,
#   INDFMINC &lt;dbl&gt;, INDFMPIR &lt;dbl&gt;, RIDEXPRG &lt;dbl&gt;, DMDHRGND &lt;dbl&gt;,
#   DMDHRAGE &lt;dbl&gt;, DMDHRBRN &lt;dbl&gt;, DMDHREDU &lt;dbl&gt;, DMDHRMAR &lt;dbl&gt;,
#   DMDHSEDU &lt;dbl&gt;, SIALANG &lt;dbl&gt;, SIAPROXY &lt;dbl&gt;, SIAINTRP &lt;dbl&gt;,
#   FIALANG &lt;dbl&gt;, FIAPROXY &lt;dbl&gt;, FIAINTRP &lt;dbl&gt;, MIALANG &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(vix_d, demo_d, <span class="at">by =</span> <span class="st">"SEQN"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the total number of rows in the merged dataset</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>total_sample_size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(merged_data)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_sample_size <span class="sc">==</span> <span class="dv">6980</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>The size is truly 6980!</p>
</section>
<section id="b" class="level2">
<h2 class="anchored" data-anchor-id="b">b</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN VIQ110 VIQ121 VIQ130 VIQ141 VIQ150 VIQ160 VIQ170 VIXNC1 VIXNC2 VIQ180
1 31129      2     NA      2     NA     NA     NA     NA     NA     NA      2
2 31130     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 31131      2     NA      2     NA     NA     NA     NA     NA     NA      2
4 31132      2     NA      2     NA      1      1      1      5     14      2
5 31133      2     NA      2     NA     NA     NA     NA     NA     NA      2
6 31134      2     NA      2     NA      1      1      1      5     15      2
  VIQ191 VIQ200 VIQ211 VIQ220 VIQ230 VIQ240 VIQ250 VIXPRS VIXPRC VIXPRA VIXPLS
1     NA      2     NA      2     NA     NA     NA     NA     NA     NA     NA
2     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3     NA      2     NA      1      1      1      1  -3.00   0.25     51  -3.25
4     NA      2     NA      1      1      1      1  -5.00   0.25    160  -5.00
5     NA      2     NA      1      1      2     NA     NA     NA     NA     NA
6     NA      2     NA      1      1      1      1  -3.25   3.25      4  -3.75
  VIXPLC VIXPLA VIXOCMT VIXORSM VIXORCM VIXORAM VIDORFM VIXOLSM VIXOLCM VIXOLAM
1     NA     NA      NA    1.75    0.25      58     9.0    1.00    0.75     104
2     NA     NA      NA      NA      NA      NA      NA      NA      NA      NA
3   0.25    148      NA   -2.75    0.25      29     9.0   -3.75    1.00     114
4   1.25    178      NA   -4.50    1.25       4     8.7   -4.75    1.00     174
5     NA     NA      NA   -4.50    1.00      62     9.0   -4.75    1.25     117
6   3.00    174      NA   -3.50    2.25     180     7.3   -4.50    3.50     174
  VIDOLFM VIXKRM1 VIXKRD1 VIXKRG1 VIXKRM2 VIXKRD2 VIXKRG2 VIXKRMM VIXKRDM
1     8.3    8.17   41.25       5    7.95   42.50      95    8.06   41.75
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3     9.0    7.43   45.50      12    7.21   46.75     102    7.32   46.00
4     8.7    7.62   44.25     156    7.55   44.75      66    7.59   44.50
5     9.0    7.74   43.50     179    7.53   44.75      89    7.64   44.25
6     8.7    7.95   42.50      99    7.62   44.25       9    7.79   43.25
  VIXKRCD VIXKRCG VIXKLM1 VIXKLD1 VIXKLG1 VIXKLM2 VIXKLD2 VIXKLG2 VIXKLMM
1    1.25      95    8.09   41.75      19    7.93   42.50     109    8.01
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3    1.25     102    7.44   45.25      11    7.13   47.25     101    7.29
4    0.50      66    7.65   44.00      77    7.58   44.50     167    7.62
5    1.25      89    7.74   43.50       9    7.44   45.25      99    7.59
6    1.75       9    8.03   42.00      86    7.55   44.75     176    7.79
  VIXKLDM VIXKLCD VIXKLCG VIDRVA VIDLVA VIDROVA VIDLOVA SDDSRVYR RIDSTATR
1   42.25    0.75     109     20     20      NA      NA        4        2
2      NA      NA      NA     NA     NA      NA      NA        4        2
3   46.25    2.00     101     20     25      NA      NA        4        2
4   44.25    0.50     167     25     25      NA      NA        4        2
5   44.50    1.75      99     25     30      NA      25        4        2
6   43.25    2.75     176     25     25      NA      NA        4        2
  RIDEXMON RIAGENDR RIDAGEYR RIDAGEMN RIDAGEEX RIDRETH1 DMQMILIT DMDBORN
1        2        1       15      189      190        4       NA       1
2        2        2       85       NA       NA        3        2       1
3        2        2       44      535      536        4        2       1
4        2        1       70      842      843        3        1       1
5        2        2       16      193      194        4       NA       1
6        2        1       73      882      883        3        1       1
  DMDCITZN DMDYRSUS DMDEDUC3 DMDEDUC2 DMDSCHOL DMDMARTL DMDHHSIZ DMDFMSIZ
1        1       NA       10       NA        1        5        6        6
2        1       NA       NA        4       NA        2        1        1
3        1       NA       NA        4       NA        1        4        4
4        1       NA       NA        5       NA        1        2        2
5        1       NA        9       NA        1        5        3        3
6        1       NA       NA        3       NA        1        2        2
  INDHHINC INDFMINC INDFMPIR RIDEXPRG DMDHRGND DMDHRAGE DMDHRBRN DMDHREDU
1       10       10     2.71       NA        1       41        1        4
2        4        4     1.99       NA        2       85        1        4
3       11       11     4.65        2        1       36        1        5
4       11       11     5.00       NA        1       70        1        5
5       11       11     5.00        2        1       47        1        2
6       12       12       NA       NA        1       73        1        3
  DMDHRMAR DMDHSEDU SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP MIALANG
1        1        4       1        1        2       1        2        2       1
2        2       NA       1        2        2       1        2        2      NA
3        1        4       1        2        2       1        2        2       1
4        1        5       1        2        2       1        2        2       1
5        1        4       1        2        2       1        2        2       1
6        1        3       1        2        2       1        2        2       1
  MIAPROXY MIAINTRP AIALANG  WTINT2YR  WTMEC2YR SDMVPSU SDMVSTRA
1        2        2       1  5316.895  5586.719       1       51
2       NA       NA      NA 29960.840 34030.995       2       46
3        2        2       1 26457.708 26770.585       1       48
4        2        2       1 32961.510 35315.539       2       52
5        2        2       1  5635.221  5920.618       1       51
6        2        2       1 43718.506 44231.167       2       48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'dplyr' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"RSQLite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'RSQLite' successfully unpacked and MD5 sums checked</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: cannot remove prior installation of package 'RSQLite'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file.copy(savedcopy, lib, recursive = TRUE): problem copying
C:\Users\Daddy\AppData\Local\R\win-library\4.4\00LOCK\RSQLite\libs\x64\RSQLite.dll
to C:\Users\Daddy\AppData\Local\R\win-library\4.4\RSQLite\libs\x64\RSQLite.dll:
Permission denied</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: restored 'RSQLite'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"knitr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'knitr' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rmarkdown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'rmarkdown' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"evaluate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'evaluate' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>year_bound <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>age_range <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>proportion <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(year_bound)){</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  lb <span class="ot">=</span> year_bound[i]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  ub <span class="ot">=</span> lb <span class="sc">+</span> <span class="dv">9</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  ages <span class="ot">=</span> <span class="fu">paste</span>(lb, <span class="st">"-"</span>, ub)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  age_range[i] <span class="ot">&lt;-</span> ages </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  filtered_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(DMDHRAGE <span class="sc">&gt;=</span> lb <span class="sc">&amp;</span> DMDHRAGE <span class="sc">&lt;=</span> ub)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(filtered_data)</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  my_list[[i]] <span class="ot">&lt;-</span> filtered_data</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  total_num <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  target_num <span class="ot">&lt;-</span> <span class="fu">nrow</span>(filtered_data[filtered_data<span class="sc">$</span>VIQ220 <span class="sc">==</span> <span class="st">"Yes"</span>, ])</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  pro <span class="ot">=</span> target_num<span class="sc">/</span>total_num</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  proportion[i] <span class="ot">&lt;-</span> pro</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age_range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0 - 9"   "10 - 19" "20 - 29" "30 - 39" "40 - 49" "50 - 59" "60 - 69"
[8] "70 - 79" "80 - 89"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]        NaN 0.06735751 0.08249721 0.06976744 0.05943293 0.04216867 0.04743590
[8] 0.04271845 0.10693642</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age_range, proportion)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age_range proportion
1     0 - 9        NaN
2   10 - 19 0.06735751
3   20 - 29 0.08249721
4   30 - 39 0.06976744
5   40 - 49 0.05943293
6   50 - 59 0.04216867
7   60 - 69 0.04743590
8   70 - 79 0.04271845
9   80 - 89 0.10693642</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(results, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Age Range"</span>, <span class="st">"Proportion"</span>), <span class="at">caption =</span> <span class="st">"Proportion of People Wearing Glasses by Age Range"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Proportion of People Wearing Glasses by Age Range</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Age Range</th>
<th style="text-align: right;">Proportion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0 - 9</td>
<td style="text-align: right;">NaN</td>
</tr>
<tr class="even">
<td style="text-align: left;">10 - 19</td>
<td style="text-align: right;">0.0673575</td>
</tr>
<tr class="odd">
<td style="text-align: left;">20 - 29</td>
<td style="text-align: right;">0.0824972</td>
</tr>
<tr class="even">
<td style="text-align: left;">30 - 39</td>
<td style="text-align: right;">0.0697674</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40 - 49</td>
<td style="text-align: right;">0.0594329</td>
</tr>
<tr class="even">
<td style="text-align: left;">50 - 59</td>
<td style="text-align: right;">0.0421687</td>
</tr>
<tr class="odd">
<td style="text-align: left;">60 - 69</td>
<td style="text-align: right;">0.0474359</td>
</tr>
<tr class="even">
<td style="text-align: left;">70 - 79</td>
<td style="text-align: right;">0.0427184</td>
</tr>
<tr class="odd">
<td style="text-align: left;">80 - 89</td>
<td style="text-align: right;">0.1069364</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="c" class="level2">
<h2 class="anchored" data-anchor-id="c">c</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN VIQ110 VIQ121 VIQ130 VIQ141 VIQ150 VIQ160 VIQ170 VIXNC1 VIXNC2 VIQ180
1 31129      2     NA      2     NA     NA     NA     NA     NA     NA      2
2 31130     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3 31131      2     NA      2     NA     NA     NA     NA     NA     NA      2
4 31132      2     NA      2     NA      1      1      1      5     14      2
5 31133      2     NA      2     NA     NA     NA     NA     NA     NA      2
6 31134      2     NA      2     NA      1      1      1      5     15      2
  VIQ191 VIQ200 VIQ211 VIQ220 VIQ230 VIQ240 VIQ250 VIXPRS VIXPRC VIXPRA VIXPLS
1     NA      2     NA      2     NA     NA     NA     NA     NA     NA     NA
2     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
3     NA      2     NA      1      1      1      1  -3.00   0.25     51  -3.25
4     NA      2     NA      1      1      1      1  -5.00   0.25    160  -5.00
5     NA      2     NA      1      1      2     NA     NA     NA     NA     NA
6     NA      2     NA      1      1      1      1  -3.25   3.25      4  -3.75
  VIXPLC VIXPLA VIXOCMT VIXORSM VIXORCM VIXORAM VIDORFM VIXOLSM VIXOLCM VIXOLAM
1     NA     NA      NA    1.75    0.25      58     9.0    1.00    0.75     104
2     NA     NA      NA      NA      NA      NA      NA      NA      NA      NA
3   0.25    148      NA   -2.75    0.25      29     9.0   -3.75    1.00     114
4   1.25    178      NA   -4.50    1.25       4     8.7   -4.75    1.00     174
5     NA     NA      NA   -4.50    1.00      62     9.0   -4.75    1.25     117
6   3.00    174      NA   -3.50    2.25     180     7.3   -4.50    3.50     174
  VIDOLFM VIXKRM1 VIXKRD1 VIXKRG1 VIXKRM2 VIXKRD2 VIXKRG2 VIXKRMM VIXKRDM
1     8.3    8.17   41.25       5    7.95   42.50      95    8.06   41.75
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3     9.0    7.43   45.50      12    7.21   46.75     102    7.32   46.00
4     8.7    7.62   44.25     156    7.55   44.75      66    7.59   44.50
5     9.0    7.74   43.50     179    7.53   44.75      89    7.64   44.25
6     8.7    7.95   42.50      99    7.62   44.25       9    7.79   43.25
  VIXKRCD VIXKRCG VIXKLM1 VIXKLD1 VIXKLG1 VIXKLM2 VIXKLD2 VIXKLG2 VIXKLMM
1    1.25      95    8.09   41.75      19    7.93   42.50     109    8.01
2      NA      NA      NA      NA      NA      NA      NA      NA      NA
3    1.25     102    7.44   45.25      11    7.13   47.25     101    7.29
4    0.50      66    7.65   44.00      77    7.58   44.50     167    7.62
5    1.25      89    7.74   43.50       9    7.44   45.25      99    7.59
6    1.75       9    8.03   42.00      86    7.55   44.75     176    7.79
  VIXKLDM VIXKLCD VIXKLCG VIDRVA VIDLVA VIDROVA VIDLOVA SDDSRVYR RIDSTATR
1   42.25    0.75     109     20     20      NA      NA        4        2
2      NA      NA      NA     NA     NA      NA      NA        4        2
3   46.25    2.00     101     20     25      NA      NA        4        2
4   44.25    0.50     167     25     25      NA      NA        4        2
5   44.50    1.75      99     25     30      NA      25        4        2
6   43.25    2.75     176     25     25      NA      NA        4        2
  RIDEXMON RIAGENDR RIDAGEYR RIDAGEMN RIDAGEEX RIDRETH1 DMQMILIT DMDBORN
1        2        1       15      189      190        4       NA       1
2        2        2       85       NA       NA        3        2       1
3        2        2       44      535      536        4        2       1
4        2        1       70      842      843        3        1       1
5        2        2       16      193      194        4       NA       1
6        2        1       73      882      883        3        1       1
  DMDCITZN DMDYRSUS DMDEDUC3 DMDEDUC2 DMDSCHOL DMDMARTL DMDHHSIZ DMDFMSIZ
1        1       NA       10       NA        1        5        6        6
2        1       NA       NA        4       NA        2        1        1
3        1       NA       NA        4       NA        1        4        4
4        1       NA       NA        5       NA        1        2        2
5        1       NA        9       NA        1        5        3        3
6        1       NA       NA        3       NA        1        2        2
  INDHHINC INDFMINC INDFMPIR RIDEXPRG DMDHRGND DMDHRAGE DMDHRBRN DMDHREDU
1       10       10     2.71       NA        1       41        1        4
2        4        4     1.99       NA        2       85        1        4
3       11       11     4.65        2        1       36        1        5
4       11       11     5.00       NA        1       70        1        5
5       11       11     5.00        2        1       47        1        2
6       12       12       NA       NA        1       73        1        3
  DMDHRMAR DMDHSEDU SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP MIALANG
1        1        4       1        1        2       1        2        2       1
2        2       NA       1        2        2       1        2        2      NA
3        1        4       1        2        2       1        2        2       1
4        1        5       1        2        2       1        2        2       1
5        1        4       1        2        2       1        2        2       1
6        1        3       1        2        2       1        2        2       1
  MIAPROXY MIAINTRP AIALANG  WTINT2YR  WTMEC2YR SDMVPSU SDMVSTRA
1        2        2       1  5316.895  5586.719       1       51
2       NA       NA      NA 29960.840 34030.995       2       46
3        2        2       1 26457.708 26770.585       1       48
4        2        2       1 32961.510 35315.539       2       52
5        2        2       1  5635.221  5920.618       1       51
6        2        2       1 43718.506 44231.167       2       48</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> merged_data <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(VIQ220 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)) <span class="co"># wear glass</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RIDRETH1 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)) <span class="co">#race</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DMDHRGND <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co"># gender</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">#DMDHRAGE age</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> filtered_data[<span class="sc">!</span><span class="fu">is.na</span>(filtered_data<span class="sc">$</span>INDFMPIR), ]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>VIQ220 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filtered_data<span class="sc">$</span>VIQ220 <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>filtered_data<span class="sc">$</span>DMDHRGND <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(filtered_data<span class="sc">$</span>DMDHRGND <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   SEQN VIQ110 VIQ121 VIQ130 VIQ141 VIQ150 VIQ160 VIQ170 VIXNC1 VIXNC2 VIQ180
1 31129      2     NA      2     NA     NA     NA     NA     NA     NA      2
2 31131      2     NA      2     NA     NA     NA     NA     NA     NA      2
3 31132      2     NA      2     NA      1      1      1      5     14      2
4 31133      2     NA      2     NA     NA     NA     NA     NA     NA      2
6 31139      2     NA      2     NA     NA     NA     NA     NA     NA      2
7 31141      2     NA      2     NA     NA     NA     NA     NA     NA      2
  VIQ191 VIQ200 VIQ211 VIQ220 VIQ230 VIQ240 VIQ250 VIXPRS VIXPRC VIXPRA VIXPLS
1     NA      2     NA      1     NA     NA     NA     NA     NA     NA     NA
2     NA      2     NA      0      1      1      1  -3.00   0.25     51  -3.25
3     NA      2     NA      0      1      1      1  -5.00   0.25    160  -5.00
4     NA      2     NA      0      1      2     NA     NA     NA     NA     NA
6     NA      2     NA      1     NA     NA     NA     NA     NA     NA     NA
7     NA      2     NA      0      1      1      1  -4.25   0.00      0  -6.25
  VIXPLC VIXPLA VIXOCMT VIXORSM VIXORCM VIXORAM VIDORFM VIXOLSM VIXOLCM VIXOLAM
1     NA     NA      NA    1.75    0.25      58     9.0    1.00    0.75     104
2   0.25    148      NA   -2.75    0.25      29     9.0   -3.75    1.00     114
3   1.25    178      NA   -4.50    1.25       4     8.7   -4.75    1.00     174
4     NA     NA      NA   -4.50    1.00      62     9.0   -4.75    1.25     117
6     NA     NA      NA   -0.25    0.00       0     9.0   -0.50    0.75      75
7   0.50     81      NA   -4.75    0.75      82     8.7   -6.75    1.25      82
  VIDOLFM VIXKRM1 VIXKRD1 VIXKRG1 VIXKRM2 VIXKRD2 VIXKRG2 VIXKRMM VIXKRDM
1     8.3    8.17   41.25       5    7.95   42.50      95    8.06   41.75
2     9.0    7.43   45.50      12    7.21   46.75     102    7.32   46.00
3     8.7    7.62   44.25     156    7.55   44.75      66    7.59   44.50
4     9.0    7.74   43.50     179    7.53   44.75      89    7.64   44.25
6     9.0    7.93   42.50     164    7.78   43.50      74    7.86   43.00
7     9.0    8.11   41.50     167    7.97   42.25      77    8.04   42.00
  VIXKRCD VIXKRCG VIXKLM1 VIXKLD1 VIXKLG1 VIXKLM2 VIXKLD2 VIXKLG2 VIXKLMM
1    1.25      95    8.09   41.75      19    7.93   42.50     109    8.01
2    1.25     102    7.44   45.25      11    7.13   47.25     101    7.29
3    0.50      66    7.65   44.00      77    7.58   44.50     167    7.62
4    1.25      89    7.74   43.50       9    7.44   45.25      99    7.59
6    1.00      74    7.99   42.25      48    7.83   43.00     138    7.91
7    0.75      77    8.18   41.25       7    7.89   42.75      97    8.04
  VIXKLDM VIXKLCD VIXKLCG VIDRVA VIDLVA VIDROVA VIDLOVA SDDSRVYR RIDSTATR
1   42.25    0.75     109     20     20      NA      NA        4        2
2   46.25    2.00     101     20     25      NA      NA        4        2
3   44.25    0.50     167     25     25      NA      NA        4        2
4   44.50    1.75      99     25     30      NA      25        4        2
6   42.75    0.75     138     40     20      25      NA        4        2
7   42.00    1.50      97     20     20      NA      NA        4        2
  RIDEXMON RIAGENDR RIDAGEYR RIDAGEMN RIDAGEEX RIDRETH1 DMQMILIT DMDBORN
1        2        1       15      189      190        4       NA       1
2        2        2       44      535      536        4        2       1
3        2        1       70      842      843        3        1       1
4        2        2       16      193      194        4       NA       1
6        2        2       18      217      217        2        2       1
7        2        1       16      195      196        1       NA       1
  DMDCITZN DMDYRSUS DMDEDUC3 DMDEDUC2 DMDSCHOL DMDMARTL DMDHHSIZ DMDFMSIZ
1        1       NA       10       NA        1        5        6        6
2        1       NA       NA        4       NA        1        4        4
3        1       NA       NA        5       NA        1        2        2
4        1       NA        9       NA        1        5        3        3
6        1       NA       13       NA        3        5        3        3
7        1       NA       10       NA        2        5        4        4
  INDHHINC INDFMINC INDFMPIR RIDEXPRG DMDHRGND DMDHRAGE DMDHRBRN DMDHREDU
1       10       10     2.71       NA        0       41        1        4
2       11       11     4.65        2        0       36        1        5
3       11       11     5.00       NA        0       70        1        5
4       11       11     5.00        2        0       47        1        2
6       11       11     4.91        2        1       18        1        3
7       11       11     5.00       NA        1       50        1        5
  DMDHRMAR DMDHSEDU SIALANG SIAPROXY SIAINTRP FIALANG FIAPROXY FIAINTRP MIALANG
1        1        4       1        1        2       1        2        2       1
2        1        4       1        2        2       1        2        2       1
3        1        5       1        2        2       1        2        2       1
4        1        4       1        2        2       1        2        2       1
6        5       NA       1        2        2       1        2        2       1
7        1        5       1        2        2       1        2        2       1
  MIAPROXY MIAINTRP AIALANG  WTINT2YR  WTMEC2YR SDMVPSU SDMVSTRA
1        2        2       1  5316.895  5586.719       1       51
2        2        2       1 26457.708 26770.585       1       48
3        2        2       1 32961.510 35315.539       2       52
4        2        2       1  5635.221  5920.618       1       51
6        2        2       1  5675.706  5963.152       1       44
7        2        2       1  6332.259  6410.895       2       48</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(VIQ220 <span class="sc">~</span> DMDHRAGE, <span class="at">data =</span> filtered_data, <span class="at">family =</span> binomial)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = VIQ220 ~ DMDHRAGE, family = binomial, data = filtered_data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.544033   0.080862   19.09   &lt;2e-16 ***
DMDHRAGE    -0.026370   0.001614  -16.33   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8519.1  on 6246  degrees of freedom
Residual deviance: 8239.2  on 6245  degrees of freedom
AIC: 8243.2

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(VIQ220 <span class="sc">~</span> DMDHRAGE <span class="sc">+</span> RIDRETH1 <span class="sc">+</span> DMDHRGND, <span class="at">data =</span> filtered_data, <span class="at">family =</span> binomial)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = VIQ220 ~ DMDHRAGE + RIDRETH1 + DMDHRGND, family = binomial, 
    data = filtered_data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.920726   0.104298  18.416  &lt; 2e-16 ***
DMDHRAGE    -0.026069   0.001621 -16.080  &lt; 2e-16 ***
RIDRETH1    -0.116571   0.022814  -5.110 3.23e-07 ***
DMDHRGND    -0.126160   0.053215  -2.371   0.0178 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8519.1  on 6246  degrees of freedom
Residual deviance: 8204.1  on 6243  degrees of freedom
AIC: 8212.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(VIQ220 <span class="sc">~</span> DMDHRAGE <span class="sc">+</span> RIDRETH1 <span class="sc">+</span> DMDHRGND <span class="sc">+</span> INDFMPIR, <span class="at">data =</span> filtered_data, <span class="at">family =</span> binomial)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = VIQ220 ~ DMDHRAGE + RIDRETH1 + DMDHRGND + INDFMPIR, 
    family = binomial, data = filtered_data)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.227954   0.111469  19.987  &lt; 2e-16 ***
DMDHRAGE    -0.025433   0.001633 -15.575  &lt; 2e-16 ***
RIDRETH1    -0.084696   0.023325  -3.631 0.000282 ***
DMDHRGND    -0.192624   0.054064  -3.563 0.000367 ***
INDFMPIR    -0.154722   0.016891  -9.160  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 8519.1  on 6246  degrees of freedom
Residual deviance: 8119.4  on 6242  degrees of freedom
AIC: 8129.4

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute odds ratios and other metrics</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>extract_model_info <span class="ot">&lt;-</span> <span class="cf">function</span>(model) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">coef</span>(model))  <span class="co"># Odds ratios</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> <span class="fu">length</span>(model<span class="sc">$</span>fitted.values)  <span class="co"># Sample size</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model)  <span class="co"># AIC value</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pseudo-R^2 (using McFadden's R^2)</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  null_deviance <span class="ot">&lt;-</span> model<span class="sc">$</span>null.deviance</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  residual_deviance <span class="ot">&lt;-</span> model<span class="sc">$</span>deviance</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  pseudo_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (residual_deviance <span class="sc">/</span> null_deviance)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">odds_ratios =</span> odds_ratios, <span class="at">sample_size =</span> sample_size, <span class="at">pseudo_r2 =</span> pseudo_r2, <span class="at">aic =</span> aic)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model1_info <span class="ot">&lt;-</span> <span class="fu">extract_model_info</span>(model1)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model2_info <span class="ot">&lt;-</span> <span class="fu">extract_model_info</span>(model2)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>model3_info <span class="ot">&lt;-</span> <span class="fu">extract_model_info</span>(model3)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Model 1: Age"</span>, <span class="st">"Model 2: Age, Race, Gender"</span>, <span class="st">"Model 3: Age, Race, Gender, PIR"</span>),</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample_Size =</span> <span class="fu">c</span>(model1_info<span class="sc">$</span>sample_size, model2_info<span class="sc">$</span>sample_size, model3_info<span class="sc">$</span>sample_size),</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pseudo_R2 =</span> <span class="fu">c</span>(<span class="fu">round</span>(model1_info<span class="sc">$</span>pseudo_r2, <span class="dv">3</span>), <span class="fu">round</span>(model2_info<span class="sc">$</span>pseudo_r2, <span class="dv">3</span>), <span class="fu">round</span>(model3_info<span class="sc">$</span>pseudo_r2, <span class="dv">3</span>)),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(model1_info<span class="sc">$</span>aic, model2_info<span class="sc">$</span>aic, model3_info<span class="sc">$</span>aic)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(summary_table, <span class="at">caption =</span> <span class="st">"Logistic Regression Models: Odds Ratios, Sample Size, Pseudo-R2, and AIC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Logistic Regression Models: Odds Ratios, Sample Size, Pseudo-R2, and AIC</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Sample_Size</th>
<th style="text-align: right;">Pseudo_R2</th>
<th style="text-align: right;">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1: Age</td>
<td style="text-align: right;">6247</td>
<td style="text-align: right;">0.033</td>
<td style="text-align: right;">8243.193</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2: Age, Race, Gender</td>
<td style="text-align: right;">6247</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">8212.106</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model 3: Age, Race, Gender, PIR</td>
<td style="text-align: right;">6247</td>
<td style="text-align: right;">0.047</td>
<td style="text-align: right;">8129.438</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="d" class="level2">
<h2 class="anchored" data-anchor-id="d">d</h2>
<p>H0: _gender = 0, H1: _gender != 0</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Estimate  Std. Error    z value     Pr(&gt;|z|)
(Intercept)  2.22795435 0.111468777  19.987250 7.110776e-89
DMDHRAGE    -0.02543300 0.001632959 -15.574791 1.080053e-54
RIDRETH1    -0.08469642 0.023325166  -3.631117 2.821968e-04
DMDHRGND    -0.19262392 0.054063870  -3.562896 3.667866e-04
INDFMPIR    -0.15472164 0.016891491  -9.159738 5.202327e-20</code></pre>
</div>
</div>
<p>As p-value for _gender &lt; 0.05, so reject H0,</p>
</section>
<section id="problem-2" class="level2">
<h2 class="anchored" data-anchor-id="problem-2">Problem 2</h2>
</section>
<section id="a-1" class="level2">
<h2 class="anchored" data-anchor-id="a-1">a</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"RSQLite"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'RSQLite' successfully unpacked and MD5 sums checked</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: cannot remove prior installation of package 'RSQLite'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in file.copy(savedcopy, lib, recursive = TRUE): problem copying
C:\Users\Daddy\AppData\Local\R\win-library\4.4\00LOCK\RSQLite\libs\x64\RSQLite.dll
to C:\Users\Daddy\AppData\Local\R\win-library\4.4\RSQLite\libs\x64\RSQLite.dll:
Permission denied</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: restored 'RSQLite'</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DBI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Installing package into 'C:/Users/Daddy/AppData/Local/R/win-library/4.4'
(as 'lib' is unspecified)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>package 'DBI' successfully unpacked and MD5 sums checked

The downloaded binary packages are in
    C:\Users\Daddy\AppData\Local\Temp\RtmpAlVBcM\downloaded_packages</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)     <span class="co"># For interfacing with a database</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the SQLite database of the Lahman data</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>lahman <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">"C:/Users/Daddy/Desktop/stats 551/Homework-for-STAST-506/sakila-sqlite3-main/sakila_master.db"</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="do">##this code for testing DBI</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> <span class="fu">dbListTables</span>(lahman)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "actor"                  "address"                "category"              
 [4] "city"                   "country"                "customer"              
 [7] "customer_list"          "film"                   "film_actor"            
[10] "film_category"          "film_list"              "film_text"             
[13] "inventory"              "language"               "payment"               
[16] "rental"                 "sales_by_film_category" "sales_by_store"        
[19] "staff"                  "staff_list"             "store"                 </code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, <span class="st">"SELECT * FROM film"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>min_year <span class="ot">&lt;-</span> <span class="fu">min</span>(table<span class="sc">$</span>release_year)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>min_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2006"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>min_row <span class="ot">&lt;-</span> <span class="fu">which.min</span>(table<span class="sc">$</span>release_year)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>min_row</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">&lt;-</span> <span class="st">"SELECT COUNT(*) as count FROM film WHERE release_year ="</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, <span class="fu">paste</span>(query, min_year))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000</code></pre>
</div>
</div>
</section>
<section id="b-1" class="level2">
<h2 class="anchored" data-anchor-id="b-1">b</h2>
<p>b method 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT category as genre, COUNT(FID) as film_count</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM film_list</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY category</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>genre_count_df <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, query)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>least_common_genre <span class="ot">&lt;-</span> genre_count_df[<span class="fu">which.min</span>(genre_count_df<span class="sc">$</span>film_count), ]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(least_common_genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   genre film_count
12 Music        281</code></pre>
</div>
</div>
<p>b method 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>query <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT category as genre, COUNT(FID) as film_count</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM film_list</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY category</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY film_count ASC</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>least_common_genre <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, query)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(least_common_genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  genre film_count
1 Music        281</code></pre>
</div>
</div>
<p>The answer is Music, 281.</p>
</section>
<section id="c-1" class="level2">
<h2 class="anchored" data-anchor-id="c-1">c</h2>
<p>c method 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>query1 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT country, COUNT(ID) as customer_count</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customer_list</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY country</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY customer_count DESC</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>count_by_country <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, query1)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>count_by_country_13 <span class="ot">&lt;-</span> count_by_country[count_by_country<span class="sc">$</span>customer_count<span class="sc">==</span><span class="dv">13</span>, ]</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(count_by_country_13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     country customer_count
11   Nigeria             13
12 Argentina             13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>query1 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT country, COUNT(ID) as customer_count</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customer_list</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY country</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="st">HAVING customer_count = 13</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>count_by_country <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(lahman, query1)</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>count_by_country</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    country customer_count
1 Argentina             13
2   Nigeria             13</code></pre>
</div>
</div>
<p>The answer is Argentina and Nigeria</p>
</section>
<section id="problem-3" class="level2">
<h2 class="anchored" data-anchor-id="problem-3">Problem 3</h2>
</section>
<section id="a-2" class="level2">
<h2 class="anchored" data-anchor-id="a-2">a</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>us_500 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/Daddy/Desktop/stats 551/Homework-for-STAST-506/us-500/us-500.csv"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(us_500)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  first_name last_name           company_name              address        city
1      James      Butt      Benton, John B Jr   6649 N Blue Gum St New Orleans
2  Josephine   Darakjy  Chanay, Jeffrey A Esq  4 B Blue Ridge Blvd    Brighton
3        Art    Venere    Chemel, James L Cpa 8 W Cerritos Ave #54  Bridgeport
4      Lenna  Paprocki Feltz Printing Service          639 Main St   Anchorage
5    Donette    Foller    Printing Dimensions         34 Center St    Hamilton
6     Simona   Morasca    Chapman, Ross E Esq         3 Mcauley Dr     Ashland
      county state   zip       phone1       phone2
1    Orleans    LA 70116 504-621-8927 504-845-1427
2 Livingston    MI 48116 810-292-9388 810-374-9840
3 Gloucester    NJ  8014 856-636-8749 856-264-4130
4  Anchorage    AK 99501 907-385-4412 907-921-2010
5     Butler    OH 45011 513-570-1893 513-549-4561
6    Ashland    OH 44805 419-503-2484 419-800-6759
                          email                                 web
1               jbutt@gmail.com        http://www.bentonjohnbjr.com
2 josephine_darakjy@darakjy.org    http://www.chanayjeffreyaesq.com
3                art@venere.org      http://www.chemeljameslcpa.com
4         lpaprocki@hotmail.com http://www.feltzprintingservice.com
5        donette.foller@cox.net   http://www.printingdimensions.com
6            simona@morasca.com      http://www.chapmanrosseesq.com</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>com_emails <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.com$"</span>, us_500<span class="sc">$</span>email)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>com_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(com_emails)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>total_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(us_500)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>proportion_com <span class="ot">&lt;-</span> com_count <span class="sc">/</span> total_count</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(proportion_com)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.732</code></pre>
</div>
</div>
<p>The answer is 0.732</p>
</section>
<section id="b-2" class="level2">
<h2 class="anchored" data-anchor-id="b-2">b</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>non_alphanumeric <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">"[^a-zA-Z0-9@.]"</span>, us_500<span class="sc">$</span>email)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>non_alphanumeric_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(non_alphanumeric)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>proportion_non_alphanumeric <span class="ot">&lt;-</span> non_alphanumeric_count <span class="sc">/</span> total_count</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(proportion_non_alphanumeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.248</code></pre>
</div>
</div>
<p>The answer is 0.248</p>
</section>
<section id="c-2" class="level2">
<h2 class="anchored" data-anchor-id="c-2">c</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>us_500<span class="sc">$</span>area_code_1 <span class="ot">&lt;-</span> <span class="fu">substr</span>(us_500<span class="sc">$</span>phone1, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>us_500<span class="sc">$</span>area_code_2 <span class="ot">&lt;-</span> <span class="fu">substr</span>(us_500<span class="sc">$</span>phone2, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>all_area_codes <span class="ot">&lt;-</span> <span class="fu">c</span>(us_500<span class="sc">$</span>area_code_1, us_500<span class="sc">$</span>area_code_2)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>area_code_freq <span class="ot">&lt;-</span> <span class="fu">table</span>(all_area_codes)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>sorted_area_codes <span class="ot">&lt;-</span> <span class="fu">sort</span>(area_code_freq, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sorted_area_codes[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>all_area_codes
973 212 215 410 201 
 36  28  28  28  24 </code></pre>
</div>
</div>
<p>The answer is 973, 212, 215, 410, 201</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>us_500<span class="sc">$</span>apartment_number <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"^(</span><span class="sc">\\</span><span class="st">d+).*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, us_500<span class="sc">$</span>address))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>apt_t <span class="ot">&lt;-</span> <span class="fu">table</span>(us_500<span class="sc">$</span>apartment_number)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(apt_t)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>logVar1 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">as.numeric</span>(df<span class="sc">$</span>Var1))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Freq <span class="ot">&lt;-</span> df<span class="sc">$</span>Freq</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df<span class="sc">$</span>logVar1, </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">80</span>,  <span class="co"># 可以根据需要调整区间数</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of Log-Transformed Apartment Numbers"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Log(Apartment Number)"</span>,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"lightblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d-1" class="level2">
<h2 class="anchored" data-anchor-id="d-1">d</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>us_500<span class="sc">$</span>first_digit <span class="ot">&lt;-</span> <span class="fu">floor</span>(us_500<span class="sc">$</span>apartment_number <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">floor</span>(<span class="fu">log10</span>(us_500<span class="sc">$</span>apartment_number))))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>digit_freq <span class="ot">&lt;-</span> <span class="fu">table</span>(us_500<span class="sc">$</span>first_digit)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>digit_prob <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(digit_freq)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Benford's Law 的理论概率</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>benford_prob <span class="ot">&lt;-</span> <span class="fu">log10</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">log10</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个数据框以便比较</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Digit =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Empirical_Probability =</span> <span class="fu">as.numeric</span>(digit_prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]),  <span class="co"># 从 digit_prob 中提取前 9 个概率</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Benford_Probability =</span> benford_prob</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印比较结果</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Digit Empirical_Probability Benford_Probability
1     1                 0.104          0.30103000
2     2                 0.126          0.17609126
3     3                 0.134          0.12493874
4     4                 0.116          0.09691001
5     5                 0.086          0.07918125
6     6                 0.110          0.06694679
7     7                 0.120          0.05799195
8     8                 0.096          0.05115252
9     9                 0.108          0.04575749</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制柱状图以可视化比较</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(<span class="fu">as.matrix</span>(comparison_df[, <span class="sc">-</span><span class="dv">1</span>])), </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">beside =</span> <span class="cn">TRUE</span>, </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Comparison of Empirical Probabilities and Benford's Law"</span>, </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"First Digit"</span>, </span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Probability"</span>,</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"lightblue"</span>, <span class="st">"salmon"</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> comparison_df<span class="sc">$</span>Digit,</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Empirical"</span>, <span class="st">"Benford's Law"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hw3_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算期望频率（理论频率）</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>total_counts <span class="ot">&lt;-</span> <span class="fu">sum</span>(digit_freq)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>expected_freq <span class="ot">&lt;-</span> total_counts <span class="sc">*</span> benford_prob</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行卡方检验</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>chisq_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(digit_freq, <span class="at">p =</span> benford_prob)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印检验结果</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chisq_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  digit_freq
X-squared = 183.09, df = 8, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>chisq_test<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.304391e-35</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (chisq_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>){</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Data not following Benford Rules!"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span>{</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Data following Benford Rules."</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Data not following Benford Rules!"</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>